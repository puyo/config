#!/usr/bin/env ruby

require 'webrick'

class CorsFileHandler < WEBrick::HTTPServlet::FileHandler
  def do_GET(req, res)
    res['Access-Control-Allow-Origin'] = '*'
    res['Access-Control-Request-Method'] = '*'
    super(req, res)
  end
end

port = ARGV.first || 3333
server = WEBrick::HTTPServer.new(Address: '0.0.0.0', Port: port)
server.mount '/', CorsFileHandler, './'
trap('INT') { server.stop }

puts "http://localhost:#{port}"
server.start
